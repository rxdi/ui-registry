{"version":3,"sources":["interceptor.ts"],"names":[],"mappings":";AAkCC,aAAA,IAAA,EAAA,MAAA,KAAA,WAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,IAAA,IAAA,EAAA,UAAA,SAAA,EAAA,GAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,IAAA,EAAA,EAAA,MAAA,IAAA,MAAA,GAAA,EAAA,IAAA,SAAA,EAAA,GAAA,EAAA,KAAA,EAAA,EAAA,OAAA,IAAA,EAAA,SAAA,GAAA,EAAA,EAAA,SAAA,KAAA,EAAA,GAAA,GAAA,EAAA,EAAA,MAAA,EAAA,GAAA,KAAA,WAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAjCD,MAAA,EAAA,QAAA,cAWA,SAAsB,EAAc,GAsBnC,OAAA,EAAA,UAAA,OAAA,EAAA,YApBQ,OADP,QAAQ,IAAI,kBAAmB,EAAQ,SAChC,CAAE,KAAM,CAAE,KAAM,YAGzB,SAAsB,EAAa,EAAoB,EAAM,EAAM,EAAkB,GAiBpF,OAAA,EAAA,UAAA,OAAA,EAAA,YAfU,OADP,QAAQ,IAAI,GACL,EAAc,EAAU,EAAM,EAAM,EAAS,KAGxD,SAAS,EAAU,EAAyB,GACnC,SAAA,GAAW,EAAQ,MAAQ,EAAc,OAAO,GAAS,IAAU,EAAQ,KAAK,MAAM,SAEzF,EAAA,oBAEN,SAAS,EAAoB,EAAoB,GAC/C,EAAU,EAAS,MAAO,GAE5B,SAAS,EAAc,EAAoB,EAAM,EAAM,EAAkB,GACnE,IAAa,EAAS,QACxB,EAAoB,EAAU,GApBlC,QAAA,cAAA,EAKA,QAAA,aAAA","file":"interceptor.js","sourceRoot":"..","sourcesContent":["import { Request } from 'hapi';\nimport { errorUnauthorized, GenericGapiResolversType } from '@gapi/core';\n\ninterface Context {\n  user: { type: string };\n}\n\ninterface Resolver extends GenericGapiResolversType {\n  scope?: string[];\n  public?: boolean;\n}\n\nexport async function OnRequestHook(request: Request) {\n  console.log('OH MY GOD PESHO', request.headers);\n  return { user: { type: 'ADMIN' } };\n}\n\nexport async function ResolverHook(resolver: Resolver, root, args, context: Context, info) {\n    console.log(context);\n    return ResolverHooks(resolver, root, args, context, info);\n}\n\nfunction canAccess(resolverScope: string[], context: Context) {\n  return context && context.user && resolverScope.filter(scope => scope === context.user.type).length\n    ? true\n    : errorUnauthorized();\n}\nfunction AuthenticationHooks(resolver: Resolver, context: Context) {\n  canAccess(resolver.scope, context);\n}\nfunction ResolverHooks(resolver: Resolver, root, args, context: Context, info) {\n  if (resolver && !resolver.public) {\n    AuthenticationHooks(resolver, context);\n  }\n}\n"]}